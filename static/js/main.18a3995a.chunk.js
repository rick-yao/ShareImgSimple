(this["webpackJsonpreact-image-server"]=this["webpackJsonpreact-image-server"]||[]).push([[3],{142:function(e,t){},157:function(e,t,n){},158:function(e,t,n){},159:function(e,t,n){},161:function(e,t,n){"use strict";n.r(t);var r,i,o,a,c,s,u=n(0),l=n(28),p=n.n(l),b=n(48),h=n(12),f=n(35),j=n.p+"static/media/first.864f19d0.svg",g=n(36),O=n(162),y=n(84),m=n(57),d=n(5),w=g.a.header(r||(r=Object(f.a)(["\n  background-color: black;\n  display: flex;\n  flex-direction: row;\n  padding: 10px 100px;\n  align-items: center;\n"]))),v=g.a.img(i||(i=Object(f.a)(["\n  height: 30px;\n"]))),x=Object(g.a)(b.b)(o||(o=Object(f.a)(["\n  color: white;\n  margin-left: 30px;\n  padding-bottom: 2px;\n  &.active {\n    border-bottom: 1px solid white;\n  }\n"]))),U=g.a.div(a||(a=Object(f.a)(["\n  margin-left: auto;\n  color: white;\n"]))),P=Object(g.a)(O.a)(c||(c=Object(f.a)(["\n  margin-right: 10px;\n  margin-left: 10px;\n"]))),L=Object(y.a)((function(){var e=Object(m.a)(),t=e.AuthStore,n=e.UserStore,r=e.HistoryStore,i=e.ImageStore,o=Object(h.f)();return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)(w,{children:[Object(d.jsx)(v,{src:j,alt:v}),Object(d.jsxs)("nav",{children:[Object(d.jsx)(x,{to:"/",exact:!0,activeClassName:"active",children:"\u9996\u9875"}),Object(d.jsx)(x,{to:"/history",activeClassName:"active",children:"\u4e0a\u4f20\u5386\u53f2"}),Object(d.jsx)(x,{to:"/about",activeClassName:"active",children:"\u5173\u4e8e"})]}),Object(d.jsx)(U,{children:n.currentUser?Object(d.jsxs)(d.Fragment,{children:[n.currentUser.attributes.username,Object(d.jsx)(P,{type:"primary",onClick:function(){n.resetUser(),r.reset(),i.reset(),t.logOut(),o.push("/")},children:"\u6ce8\u9500"})]}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(P,{type:"primary",onClick:function(){o.push("/login")},children:"\u767b\u5f55"}),Object(d.jsx)(P,{type:"primary",onClick:function(){o.push("/register")},children:"\u6ce8\u518c"})]})})]})})})),k=g.a.footer(s||(s=Object(f.a)(["\n  padding: 10px 100px;\n  text-align: center;\n  color: #aaa;\n  font-size: 12px;\n"])));var z=function(){return Object(d.jsx)(k,{children:Object(d.jsx)("p",{children:"\u611f\u8c22Imgur\u53caLeanCloud\u63d0\u4f9b\u7684\u514d\u8d39\u670d\u52a1"})})},D=n(165),I=n(166),H=n(167),N=n(163);var S=function(){return Object(d.jsx)(D.a,{justify:"center",align:"middle",style:{minHeight:"100vh"},children:Object(d.jsx)(I.a,{children:Object(d.jsx)(H.b,{size:"middle",children:Object(d.jsx)(N.a,{size:"large"})})})})},C=(n(157),n(158),n(159),Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(8),n.e(10)]).then(n.bind(null,297))}))),F=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(7),n.e(11)]).then(n.bind(null,288))})),A=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(6),n.e(9)]).then(n.bind(null,298))})),M=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(13)]).then(n.bind(null,290))})),q=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(12)]).then(n.bind(null,291))})),B=function(){return Object(m.a)().UserStore.autoLogin(),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(L,{}),Object(d.jsx)("main",{children:Object(d.jsx)(u.Suspense,{fallback:Object(d.jsx)(S,{}),children:Object(d.jsxs)(h.c,{children:[Object(d.jsx)(h.a,{path:"/",exact:!0,component:C}),Object(d.jsx)(h.a,{path:"/history",component:A}),Object(d.jsx)(h.a,{path:"/about",component:F}),Object(d.jsx)(h.a,{path:"/login",component:q}),Object(d.jsx)(h.a,{path:"/register",component:M})]})})}),Object(d.jsx)(z,{})]})};n(160);p.a.render(Object(d.jsx)(b.a,{children:Object(d.jsx)(B,{})}),document.getElementById("root"))},57:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n(18),i=n(37),o=n(38),a=n(8),c=(n(62),n(4)),s=n(26),u=n.n(s),l=n(75),p=n.n(l),b=n(106),h=n.n(b);u.a.init({appId:"2DYaDCQetWnTHjsa6ovwAka9-gzGzoHsz",appKey:"xtVxgssNxOXPbBdfPIWrKGoW",serverURL:"https://2dyadcqe.lc-cn-n1-shared.com"});var f,j,g,O,y,m,d,w,v,x,U,P,L,k,z,D,I,H,N=function(e,t){var n=new s.User;return n.setUsername(e),n.setPassword(t),new Promise((function(e,t){n.signUp().then((function(t){return e(t)}),(function(e){return t(e)}))}))},S=function(){return new Promise((function(e,t){var n=u.a.User.current();n?e(n):t("\u65e0\u5386\u53f2\u767b\u5f55\u7528\u6237")}))},C=function(e,t){return new Promise((function(n,r){s.User.logIn(e,t).then((function(e){return n(e)}),(function(e){return r(e)}))}))},F=function(){s.User.logOut().then((function(e){return console.log(e+"\u6ce8\u9500\u6210\u529f")}))},A=function(){return s.User.current()},M=function(e,t){return new Promise((function(n,r){(function(e,t){var n=new FormData;n.append("image",e),n.append("description",t);var r=h()(e).toString();return p.a.defaults.headers.common.Authorization="Bearer Bearer 1b43d718f8c86689f09d3bface210dbf93da03a1",p.a.defaults.baseURL="https://api.imgur.com/3/",new Promise((function(e,i){p()({method:"POST",url:"/image",data:n,headers:{Authorization:"Client-ID 19f50553247062b"}}).then((function(n){var i=new(u.a.Object.extend("ImageInfo"));i.set("title",t),i.set("owner",u.a.User.current()),i.set("link",n.data.data.link),i.set("hash",r),i.set("imageId",n.data.data.id),i.save(),console.log(n),e(n)})).catch((function(e){return i(e)}))}))})(e,t).then((function(e){n(e)})).catch((function(e){return r(e)}))}))},q=function(e,t){var n=new u.a.Query("ImageInfo");return n.equalTo("owner",u.a.User.current()),n.descending("createdAt"),n.limit(t),n.skip(t*e),console.log("sent request"),new Promise((function(e,t){n.find().then((function(t){e(t)}),(function(e){return t(e)}))}))},B=function(){var e=new u.a.Query("ImageInfo");return e.equalTo("owner",u.a.User.current()),new Promise((function(t){e.count().then((function(e){t(e)}))}))},T=new(f=function(){function e(){Object(i.a)(this,e),Object(r.a)(this,"currentUser",j,this),Object(c.m)(this)}return Object(o.a)(e,[{key:"pullUser",value:function(){this.currentUser=A()}},{key:"autoLogin",value:function(){var e=this;S().then((function(t){e.currentUser=t})).catch((function(e){}))}},{key:"resetUser",value:function(){this.currentUser=null}}]),e}(),j=Object(a.a)(f.prototype,"currentUser",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(a.a)(f.prototype,"pullUser",[c.f],Object.getOwnPropertyDescriptor(f.prototype,"pullUser"),f.prototype),Object(a.a)(f.prototype,"autoLogin",[c.f],Object.getOwnPropertyDescriptor(f.prototype,"autoLogin"),f.prototype),Object(a.a)(f.prototype,"resetUser",[c.f],Object.getOwnPropertyDescriptor(f.prototype,"resetUser"),f.prototype),f),Q=new(g=function(){function e(){Object(i.a)(this,e),Object(r.a)(this,"isLoading",O,this),Object(r.a)(this,"values",y,this),Object(c.m)(this)}return Object(o.a)(e,[{key:"setUserName",value:function(e){this.values.username=e}},{key:"setPassword",value:function(e){this.values.password=e}},{key:"login",value:function(){var e=this;return new Promise((function(t,n){C(e.values.username,e.values.password).then((function(e){T.pullUser(),t(e)})).catch((function(e){console.log("\u767b\u5f55\u5931\u8d25"),n(e)}))}))}},{key:"register",value:function(){var e=this;return new Promise((function(t,n){N(e.values.username,e.values.password).then((function(e){T.pullUser(),console.log("\u6ce8\u518c\u6210\u529f"),t(e)})).catch((function(e){console.log("\u6ce8\u518c\u5931\u8d25"),n(e)}))}))}},{key:"logOut",value:function(){F(),T.resetUser()}}]),e}(),O=Object(a.a)(g.prototype,"isLoading",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=Object(a.a)(g.prototype,"values",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{username:"",password:""}}}),Object(a.a)(g.prototype,"setUserName",[c.f],Object.getOwnPropertyDescriptor(g.prototype,"setUserName"),g.prototype),Object(a.a)(g.prototype,"setPassword",[c.f],Object.getOwnPropertyDescriptor(g.prototype,"setPassword"),g.prototype),Object(a.a)(g.prototype,"login",[c.f],Object.getOwnPropertyDescriptor(g.prototype,"login"),g.prototype),Object(a.a)(g.prototype,"register",[c.f],Object.getOwnPropertyDescriptor(g.prototype,"register"),g.prototype),Object(a.a)(g.prototype,"logOut",[c.f],Object.getOwnPropertyDescriptor(g.prototype,"logOut"),g.prototype),g),W=new(m=function(){function e(){Object(i.a)(this,e),Object(r.a)(this,"imageName",d,this),Object(r.a)(this,"image",w,this),Object(r.a)(this,"isUpLoading",v,this),Object(r.a)(this,"serverFile",x,this),Object(r.a)(this,"fileHash",U,this),Object(c.m)(this)}return Object(o.a)(e,[{key:"setImageName",value:function(e){this.imageName=e}},{key:"setImage",value:function(e){this.image=e}},{key:"setHash",value:function(e){this.fileHash=e}},{key:"reset",value:function(){this.imageName="",this.image=null,this.isUpLoading=!1,this.serverFile=null,this.fileHash=""}},{key:"upload",value:function(){var e=this;return this.isUpLoading=!0,new Promise((function(t,n){M(e.image,e.imageName).then((function(n){console.log(n),e.serverFile=n,t(n)})).catch((function(e){return n(e)})).finally((function(){e.isUpLoading=!1}))}))}}]),e}(),d=Object(a.a)(m.prototype,"imageName",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),w=Object(a.a)(m.prototype,"image",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=Object(a.a)(m.prototype,"isUpLoading",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=Object(a.a)(m.prototype,"serverFile",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=Object(a.a)(m.prototype,"fileHash",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(a.a)(m.prototype,"setImageName",[c.f],Object.getOwnPropertyDescriptor(m.prototype,"setImageName"),m.prototype),Object(a.a)(m.prototype,"setImage",[c.f],Object.getOwnPropertyDescriptor(m.prototype,"setImage"),m.prototype),Object(a.a)(m.prototype,"setHash",[c.f],Object.getOwnPropertyDescriptor(m.prototype,"setHash"),m.prototype),Object(a.a)(m.prototype,"reset",[c.f],Object.getOwnPropertyDescriptor(m.prototype,"reset"),m.prototype),Object(a.a)(m.prototype,"upload",[c.f],Object.getOwnPropertyDescriptor(m.prototype,"upload"),m.prototype),m),G=n(114),J=new(P=function(){function e(){Object(i.a)(this,e),Object(r.a)(this,"list",L,this),Object(r.a)(this,"listLength",k,this),Object(r.a)(this,"hasMore",z,this),Object(r.a)(this,"isLoading",D,this),Object(r.a)(this,"page",I,this),Object(r.a)(this,"limit",H,this),Object(c.m)(this)}return Object(o.a)(e,[{key:"append",value:function(e){this.list=this.list.concat(e)}},{key:"getListLength",value:function(){var e=this;B().then((function(t){e.listLength=t}))}},{key:"reset",value:function(){this.list=[],this.listLength=0,this.hasMore=!0,this.isLoading=!1,this.page=0,this.limit=10}},{key:"getHistory",value:function(){var e=this;console.log("\u8fdb\u5165\u51fd\u6570"),console.log(!this.isLoading&&this.hasMore),this.isLoading=!0,q(this.page,this.limit).then((function(t){e.append(t),e.page++,t.length<e.limit&&(console.log("hasmore\u53d8\u4e86"),e.hasMore=!1),console.log(e.listLength),console.log(t),e.isLoading=!1})).catch((function(e){G.b.error("\u52a0\u8f7d\u6570\u636e\u5931\u8d25").then()})).finally((function(){e.isLoading=!1,console.log(e.isLoading)}))}}]),e}(),L=Object(a.a)(P.prototype,"list",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=Object(a.a)(P.prototype,"listLength",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=Object(a.a)(P.prototype,"hasMore",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),D=Object(a.a)(P.prototype,"isLoading",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=Object(a.a)(P.prototype,"page",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),H=Object(a.a)(P.prototype,"limit",[c.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),Object(a.a)(P.prototype,"append",[c.f],Object.getOwnPropertyDescriptor(P.prototype,"append"),P.prototype),Object(a.a)(P.prototype,"getListLength",[c.f],Object.getOwnPropertyDescriptor(P.prototype,"getListLength"),P.prototype),Object(a.a)(P.prototype,"reset",[c.f],Object.getOwnPropertyDescriptor(P.prototype,"reset"),P.prototype),Object(a.a)(P.prototype,"getHistory",[c.f],Object.getOwnPropertyDescriptor(P.prototype,"getHistory"),P.prototype),P),K=n(0),R=Object(K.createContext)({AuthStore:Q,UserStore:T,ImageStore:W,HistoryStore:J}),E=function(){return Object(K.useContext)(R)}}},[[161,4,5]]]);
//# sourceMappingURL=main.18a3995a.chunk.js.map